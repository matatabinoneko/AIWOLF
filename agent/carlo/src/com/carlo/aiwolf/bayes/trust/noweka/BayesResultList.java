package com.carlo.aiwolf.bayes.trust.noweka;

import org.aiwolf.common.data.Agent;
import org.aiwolf.common.data.Role;
import org.aiwolf.common.data.Species;

import com.carlo.aiwolf.bayes.trust.Correct;

/**
 * ベイジアンネットワークの計算結果をハードコーディングしたもの
 * 毎回計算しているとコストがやばいので...
 * @author info
 *
 */
public class BayesResultList {
	/** 日数ごとの閾値 */
	private double[] seerBayesThreshold={0.016744050831323284,0.3633872740364856,0.34576317050722255,0.3750486611625374
			,0.315052269410793,0.313899368765621,0.2843986483707879,0.30780677881139146,0.14360365302805994,0.14360365302805994};

	
	/**
	 * 事後確率
	 * [日数][種族][正解][被襲撃]
	 *  種族 0:人間　1:人狼
	 *  正解/被襲撃 0:不明 1:被襲撃有り 2:無し
	 */
	private double[][][][] seerBayesMargin={{{{0.01194194780858565,0.013431296164552145,0.010821268986515888,},
		{0.01382867466232493,0.013450572032121811,0.014245187437402709,},
		{0.003464981407323217,0.000337639641788993,0.003475861671326611,},
		},
		{{0.05689625583520674,0.017173965021120396,0.07317691601685448,},
		{0.15500826435459836,0.8244502874149046,0.144232177177971,},
		{0.007905726418315946,0.00225219864359436,0.012135325790096407,},
		},
		},
		{{{0.3718600312508659,0.47946696416801554,0.26273912250656656,},
		{0.4714168958305098,0.4794911184885384,0.45716797312691615,},
		{0.000120083097404646,0.000337639641788993,0.000120056954064302,},
		},
		{{0.3388751231125044,0.002477705618242526,0.3485785826878677,},
		{0.8350683423487808,0.8244502874149046,0.8350702638768099,},
		{0.000123450457129758,0.000319867554225405,0.000113751990851146,},
		},
		},
		{{{0.3218808779858622,0.37692234655885376,0.27290685583166335,},
		{0.384337395250567,0.37693690715504774,0.3938408238570727,},
		{0.000111923419205437,0.000337639641788993,0.000111898138613425,},
		},
		{{0.47212898419377597,0.002035978232558784,0.49415423530485447,},
		{0.895195490015482,0.8244502874149047,0.8952084117194887,},
		{0.000203585617652393,0.000262718346909299,0.000197416047190276,},
		},
		},
		{{{0.38863558048766994,0.4353148252444856,0.3423635199641353,},
		{0.4290469643594865,0.43533565479371367,0.4213737974907236,},
		{0.000252782058458385,0.000337639641788993,0.00025276058996223,},
		},
		{{0.33234372702516946,0.000883773223859703,0.3612447646462618,},
		{0.804785370907064,0.8244502874149046,0.8047818026920062,},
		{0.000127494574863081,0.000113901252464461,0.00012964280342639,},
		},
		},
		{{{0.31965922973531086,0.34332779269492986,0.30086519557367225,},
		{0.350951718128014,0.34335662848133075,0.35813150189850923,},
		{0.000416546738419187,0.000337639641788993,0.000416579639919943,},
		},
		{{0.30235671280384596,0.000934341324595234,0.3372739906852387,},
		{0.7513792833348076,0.8244502874149046,0.7513606588788737,},
		{0.000171384661997749,0.000120424942572252,0.000182082963908491,},
		},
		},
		{{{0.31288672103700943,0.3429968913014983,0.29196655109153075,},
		{0.35049513460781784,0.34305027583198777,0.3568180206179355,},
		{0.000593783058333088,0.000337639641788993,0.000593935331704426,},
		},
		{{0.31663094984723134,0.001802906243287626,0.3479151516809566,},
		{0.80212114588936,0.8244502874149047,0.8021113951214954,},
		{0.000284248995147385,0.000232585818601421,0.000293294584626333,},
		},
		},
		{{{0.263159747367108,0.23296161722812078,0.2877904703689396,},
		{0.2895602422810208,0.23302035793977227,0.3448442476713633,},
		{0.001237811682662783,0.000337639641788993,0.001238927962753137,},
		},
		{{0.33382672558194565,0.002179796851454583,0.3767290879548754,},
		{0.8474032074068858,0.8244502874149047,0.8474186032256437,},
		{0.000434872958411311,0.000281319246130745,0.000470533361827541,},
		},
		},
		{{{0.2679509351643192,0.20005768687719058,0.3183558974144318,},
		{0.28639158692022637,0.20019885407327356,0.35852413580856646,},
		{0.00459624396086943,0.000337639641788993,0.004615919521801416,},
		},
		{{0.40584173784435823,0.007681358597104936,0.4457837999652986,},
		{0.8609884973465395,0.8244502874149047,0.8610460585387796,},
		{0.001396836892375849,0.000997147930171814,0.001479158176571652,},
		},
		},
		{{{0.11610874973958253,0.017958932255676522,0.2049583193679627,},
		{0.11947498870342264,0.01799363540704605,0.21772124274751284,},
		{0.025935145127545103,0.000337639641788993,0.026617107007513987,},
		},
		{{0.2233755142518062,0.02641560334828696,0.2445415576061404,},
		{0.6963709500465042,0.8244502874149046,0.695266683418945,},
		{0.003962873012470073,0.003498952537400744,0.004037195497913871,},
		},
		},
		{{{0.11610874973958253,0.017958932255676522,0.2049583193679627,},
		{0.11947498870342264,0.01799363540704605,0.21772124274751284,},
		{0.025935145127545103,0.000337639641788993,0.026617107007513987,},
		},
		{{0.2233755142518062,0.02641560334828696,0.2445415576061404,},
		{0.6963709500465042,0.8244502874149046,0.695266683418945,},
		{0.003962873012470073,0.003498952537400744,0.004037195497913871,},
		},
		}};
	/** idx:0 =  day:1*/
	private double[] voterBayesThreshold={0.8000732200042768,0.7936259274122024,0.7894196785665655,0.787006908090173,0.7784175634349048,0.7517970511570453,0.7226090999468698,0.6964396991121564};
	
	private double[][][] voterBayesMargin={{
		{0.8000732200042768,0.7971728478782003,0.8018890249445702},{0.7564839509167147,0.7391594728126786,0.7662862710905454,},{0.9409491558988615,0.9439798517539962,0.9383518494161918}},{
			{0.7936259274122024,0.8031057179436951,0.7881246185291484},{0.7461013812492349,0.7394668334559243,0.7493617550081757,},{0.9328658989077201,0.9317079665879476,0.9339250457566939}},{
			{0.7894196785665655,0.816662669403363,0.7697278948265319},{0.726841300959217,0.7405321275386737,0.7190363750575667,},{0.9312173126365597,0.9310649460265259,0.9314016687051099}},{
			{0.787006908090173,0.8154004850794192,0.7644570781187916},{0.726119974090395,0.7419053988050346,0.716657031554418,},{0.9268469038610425,0.9211090832251078,0.9353992607442406}},{
			{0.7784175634349048,0.8029253178266543,0.756980686014098},{0.7162020280671451,0.728595913987581,0.707052926060877,},{0.9359431748436334,0.9424981529354931,0.9271597090619524}},{
			{0.7517970511570453,0.7814036183770772,0.720920393594443},{0.6667764572710619,0.6893479050788504,0.6473595122646825,},{0.9462431188401961,0.9383276737553827,0.9591810065994092}},{
			{0.7226090999468698,0.7468596259830373,0.6908672950930637},{0.6125698520820052,0.6309154086503711,0.5906965376243903,},{0.9641133897084893,0.970991287273235,0.953011801985376}},{
			{0.6964396991121564,0.7662857061354564,0.5977125858802788},{0.5320397338236971,0.5883266745509077,0.4735435805519156,},{0.9598265478852785,0.9716584247907095,0.9312092345286547}}};
	
	
	private double[] mediumBayesThreshold={0,0,0.7298846727768095,0.7108488197814423,0.5972082634773213,0.6303029175522281,0.6244606312156216,0.6188178916086721,0.6582938121295099};
	
	private double[][] mediumBayesMargin={{0,0},{0,0},{0.8218674252767648,0.5868729603083814,},{0.7265193913606641,0.6876296831470375,},{0.5691850612435998,0.6488520019255677,},{0.556335183813653,0.7813438481385259,},{0.5797477506637928,0.7803286862483393,},{0.5899957783220555,0.8048990143470819,},{0.6330654123063566,0.794327499106488,}};
	
	/** role.values の順番 */
	private double[] attackedBayesThreshold={0.9941204354719373,0,0.6724439474385231,0.5001192368792037,0.3501455008612595,0.7946063736895327,0.038479180936768054,0.8391350466859375};
	
	private double[] attackedBayesMargin={0.9925526147461737,0,0.9604468792062572,0.5001192368792037,0.6648608987518022,0.9763525931787361,0.34221261746336906,0.9861467452010078};
	
	/** 閾値を返す(日数のみを所与として与えた場合の事後確率) */ 
	public double getSeerBayesThreshold(int day){
		return (day < 9 ) ?  seerBayesThreshold[day] : seerBayesThreshold[9];
	}
	/** 事後確率を返す  */
	public double getSeerBayesMargin(int day,Species result,Correct correct,Correct attacked){
		int resultIdx= (result==Species.HUMAN) ? 0 : 1;
		int correctIdx=0;
		if(correct==Correct.YES) correctIdx=1;
		if(correct==Correct.NO) correctIdx=2;
		int attackedIdx=0;
		if(attacked==Correct.YES) attackedIdx=1;
		if(attacked==Correct.NO) attackedIdx=2;
		
		return (day<8) ? seerBayesMargin[day][resultIdx][correctIdx][attackedIdx] : seerBayesMargin[8][resultIdx][correctIdx][resultIdx];
	}
	public double getVoterBayesThreshold(int day){
		if(day==0) return voterBayesThreshold[0];
		return (day < 8 ) ?  voterBayesThreshold[day-1] : voterBayesThreshold[7];
	}
	public double getVoterBayesMargin(int day,Species targetSpecies,String assist){
		if(day==0) return voterBayesMargin[0][0][0];
		
		int dayIdx=day-1;
		int targetIdx=0;
		if(targetSpecies==Species.HUMAN) targetIdx=1;
		else if(targetSpecies==Species.WEREWOLF) targetIdx=2;
		
		int assistIdx=0;
		if(assist!=null){
			if(assist=="true") assistIdx=1;
			else if(assist=="false") assistIdx=2;
		}
		
		return day<8 ? voterBayesMargin[dayIdx][targetIdx][assistIdx] : voterBayesMargin[7][targetIdx][assistIdx];
	}
	public double getMediumBayesThreshold(int day){
		return (day<9) ?  mediumBayesThreshold[day] : mediumBayesThreshold[8];
	}
	public double getMediumBayesMargin(int day,Species targetSpecies){
		int targetIdx= (targetSpecies==Species.HUMAN) ? 0 :1;
		return (day<9) ? mediumBayesMargin[day][targetIdx] : mediumBayesMargin[8][targetIdx];
	}
	public double getAttackedBayesThreshold(Role coRole){
		if(coRole==null) return attackedBayesThreshold[attackedBayesThreshold.length-1];
		return attackedBayesThreshold[coRole.ordinal()];
	}
	public double getAttackedBayesMargin(Role coRole){
		if(coRole==null) return attackedBayesMargin[attackedBayesMargin.length-1];
		return attackedBayesMargin[coRole.ordinal()];
	}
}
